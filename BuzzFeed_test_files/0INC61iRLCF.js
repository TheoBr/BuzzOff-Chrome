/*!CK:3576511967!*//*1414993869,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["v3+43"]); }

__d("ActivityLogStory",["ge","DOM","Event","Toggler","Run"],function(a,b,c,d,e,f,g,h,i,j,k){var l={removeStory:function(m,n){var o=g(m);o&&h.setContent(o,n);},registerPopover:function(m){var n=i.listen(window,'scroll',function(o){j.hide(m);});k.onLeave(n.remove.bind(n));}};e.exports=l;},null);
__d("AllActivityContentLoader",["Arbiter","CSS","DOM","DOMScroll","OnVisible","Parent","MorePagerFetchOnScroll","TimelineConstants","TimelineController","TimelineLegacySections","TimelineSmartInsert","UIPagelet","Vector","$","clickRefAction","copyProperties","csx","userAction"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){var y=false,z=0,aa=null,ba={},ca=[],da={},ea=[],fa=null,ga=null;function ha(la,ma,na,oa,pa){this.node=la;this.canScrollLoad=true;this.scrubberKey=ma;this._pageletLoadData=na;this.loaded=oa;this.sortKey=pa;this.contentNode=i.scry(la,"div._z6j")[0];}function ia(){if(y)return;o.register(o.CONTENT,ka);fa=x('allactivity').uai('init','scrubber',false);u('scrubber').set_namespace('allactivity');y=true;}function ja(la){var ma=p.get(la);ma&&ma.canScrollLoad&&ma.load();}v(ha.prototype,{load:function(){if(this.loaded)return;this.loaded=true;this.contentNode&&h.hide(this.contentNode);h.show(l.byClass(this.node,'fbTimelineSection'));var la=this.node;function ma(oa){q.run(la,oa);}var na=i.find(this.node,'div.fbTimelineLogStream');ea.push(r.loadFromEndpoint('TimelineEntStoryActivityLogPagelet',na.id,this._pageletLoadData,{usePipe:true,jsNonblock:true,constHeight:true,displayCallback:ma,append:true}));},contentAdded:function(la){if(!this.hasContent){h.removeClass(l.byClass(this.node,'stat_elem'),'async_saving');if(this.contentNode){la&&i.prependContent(this.contentNode,la);h.show(this.contentNode);}this.hasContent=true;}},fullyLoaded:function(){if(!this.hasContent){h.removeClass(l.byClass(this.node,'stat_elem'),'async_saving');h.show(i.find(this.node,"div._40pu"));this.contentNode&&h.hide(this.contentNode);}},activateScrollLoad:function(){this.canScrollLoad=true;da[this.scrubberKey]&&da[this.scrubberKey].reset();},deactivateScrollLoad:function(){if(!this.loaded){this.canScrollLoad=false;}else{var la=i.scry(this.node,'.uiMorePager');if(la)la.map(function(ma){var na=m.getInstance(ma.id);na&&na.removeEventListeners();});}da[this.scrubberKey]&&da[this.scrubberKey].remove();},getParent:function(){if(this.parentKey)return p.get(this.parentKey);return null;}});var ka={SCROLL_TO_OFFSET:115,HEADER_SCROLL_CUTOFF:30,CURRENT_SECTION_OFFSET:150,registerTimePeriod:function(la,ma,na,oa,pa,qa){ia();var ra=new ha(la,ma,na,oa,qa);if(!pa){ca.push(ma);ba[ma]=true;}else{ra.parentKey=pa;p.get(pa).subSections=p.get(pa).subSections||[];p.get(pa).subSections.push(ra);p.get(pa).subSections.sort(function(sa,ta){return ta.sortKey-sa.sortKey;});}p.set(ma,ra);ka.checkCurrentSectionChange();g.inform(n.SECTION_REGISTERED,{scrubberKey:ma},g.BEHAVIOR_PERSISTENT);},reset:function(){ka.stopLoadingContent();y=false;p.removeAll();z=0;aa=null;ba={};ca=[];da={};ea=[];fa=null;ga=null;},stopLoadingContent:function(){for(var la in da)da[la]&&da[la].remove();for(var ma=0;ma<ea.length;ma++)ea[ma].cancel();},setContentHeader:function(la){ga=la;},checkCurrentSectionChange:function(){var la=ka.getCurrentSection(),ma=aa&&aa.scrubberKey;if(la&&la.scrubberKey!==ma){aa=la;var na=la.scrubberKey,oa=la.parentKey;if(!oa){oa=na;na=null;}o.sectionHasChanged(oa,na);}},getCurrentSection:function(){var la={},ma=p.getAll();for(var na in ma){var oa=ma[na];if(!oa.loaded)continue;var pa=s.getElementPosition(oa.node,'viewport').y;if(pa<ka.CURRENT_SECTION_OFFSET)la[pa]=oa;}var qa=Math.max.apply(this,Object.keys(la)),ra=qa==-Infinity;if(!ra){return la[qa];}else return null;},enableScrollLoad:function(la,ma,na){la=t(la);var oa=ka.getNextSectionKey(ma);if(oa)da[oa]=new k(la,ja.bind(null,oa),false,na||1000);},getNextSectionKey:function(la){var ma=p.get(la),na=ma.getParent(),oa=null,pa=null;if(na)for(var qa=0;qa<na.subSections.length-1;qa++)if(na.subSections[qa].scrubberKey==la)oa=na.subSections[qa+1].scrubberKey;if(!oa)for(var ra=0;ra<ca.length-ra;ra++)if(ca[ra]==na.scrubberKey){pa=p.get(ca[ra+1]).subSections[0];if(pa)oa=pa.scrubberKey;}return oa;},navigateToSection:function(la,ma,na){fa.add_event("nav_"+la);ma=!!ma;var oa=p.get(la);if(!oa)return;if(!oa.getParent()){la=oa.subSections[0].scrubberKey;oa=p.get(la);}for(var pa=0;pa<ca.length;pa++){var qa=p.get(ca[pa]);for(var ra=0;ra<qa.subSections.length;ra++){if(qa.subSections[ra].scrubberKey==la)break;qa.subSections[ra].deactivateScrollLoad();}if(qa.scrubberKey==oa.getParent().scrubberKey)break;}oa.activateScrollLoad();oa.load();ka.adjustContentPadding();var sa=s.getScrollPosition().x,ta=s.getElementPosition(oa.node).y;if(!ma){var ua=ka.SCROLL_TO_OFFSET;j.scrollTo(new s(sa,ta-ua,'document'));}},adjustContentPadding:function(){t('fbTimelineLogBody').style.paddingBottom=s.getViewportDimensions().y-ka.CURRENT_SECTION_OFFSET-ka.HEADER_SCROLL_CUTOFF+'px';},sectionHasContent:function(la){var ma=p.get(la);ma&&ma.contentAdded(ga);ga=null;},sectionFullyLoaded:function(la){var ma=p.get(la);ma&&ma.fullyLoaded();}};e.exports=ka;},null);
__d("ActivityLogSearch",["Event","CSS","DOM","Input","Run"],function(a,b,c,d,e,f,g,h,i,j,k){function l(m,n,o){var p=i.find(o,'.inputtext'),q=g.listen(n,'click',function(){h.hide(m);h.show(o);p.focus();});k.onLeave(q.remove.bind(q));var r=g.listen(p,'blur',function(){if(!j.getValue(p)){h.hide(o);h.show(m);}});k.onLeave(r.remove.bind(r));}e.exports=l;},null);
__d("PopoverMenuDynamicTooltip",["DOMQuery","Tooltip","csx"],function(a,b,c,d,e,f,g,h,i){function j(k){"use strict";this._popoverMenu=k;this._setMenuSubscription=null;this._changeSubscription=null;}j.prototype.enable=function(){"use strict";this._setMenuSubscription=this._popoverMenu.subscribe('setMenu',this._onSetMenu.bind(this));};j.prototype.disable=function(){"use strict";this._popoverMenu.unsubscribe(this._setMenuSubscription);this._setMenuSubscription=null;this._removeChangeSubscription();};j.prototype._onSetMenu=function(){"use strict";this._removeChangeSubscription();this._menu=this._popoverMenu.getMenu();this._changeSubscription=this._menu.subscribe('change',function(k,l){var m=l.item;if(l[0])m=l[0].item;if(!m)return;var n=m.getLabel();n=n?n.toString():null;if(!n)return;var o=this._popoverMenu.getTriggerElem(),p=g.scry(o,"span._55pe")[0];if(p&&p.nodeName){var q=p.parentNode;if(q)h.set(q,n);}}.bind(this));};j.prototype._removeChangeSubscription=function(){"use strict";if(this._changeSubscription){this._menu.unsubscribe(this._changeSubscription);this._changeSubscription=null;}};e.exports=j;},null);
__d("ScrollHighlight",["DOMScroll","highlight"],function(a,b,c,d,e,f,g,h){var i={actOn:function(j,k,l){g.scrollTo(j,true,false,false,l);h(j,null,k);}};e.exports=i;},null);
__d("ProfileApprovalController",["AsyncRequest","DOM","Event","HTML","$","copyProperties","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(o){"use strict";this.queueType=o;var p=m('profileApprovalSeeMoreLink');if(p)i.listen(p,'click',this.clickedSeeMore.bind(this));}n.prototype.getNewStories=function(){"use strict";var o=this.getStoryData(),p={filter:this.FILTER_NEWER,filter_timestamp:o.newest_time,filter_fbid:o.newest_fbid};new g().setURI('/ajax/profile/approval/get_more.php').setData(p).setHandler(this.handleContent).send();};n.prototype.clickedSeeMore=function(){"use strict";var o=this.getStoryData(),p={queue_type:this.queueType,filter:this.FILTER_OLDER,filter_timestamp:o.oldest_time,filter_fbid:o.oldest_fbid};new g().setURI('/ajax/profile/approval/get_more.php').setData(p).setHandler(this.handleContent).send();};n.prototype.handleContent=function(o){"use strict";var p=o.payload;if(p.pager_error){h.replace(k('profileApprovalSeeMoreContainer'),j(p.pager_markup));return;}if(p.hide_more_pager)h.remove(k('profileApprovalSeeMoreContainer'));if(!p.items_markup)return;if(p.insert_before)h.prependContent(h.find(k('profileApprovalContentContainer'),'.profileApprovalList'),j(p.items_markup));if(p.insert_after)h.appendContent(h.find(k('profileApprovalContentContainer'),'.profileApprovalList'),j(p.items_markup));};n.prototype.getStoryData=function(){"use strict";var o=h.scry(k('profileApprovalContentContainer'),'.profileApprovalStoryContainer');if(!o)return;var p=o[0],q=o[o.length-1];return {newest_time:p.getAttribute('data-timestamp'),newest_fbid:p.getAttribute('data-fbid'),oldest_time:q.getAttribute('data-timestamp'),oldest_fbid:q.getAttribute('data-fbid')};};n.NO_MORE_CONTENT='no_more_content';l(n.prototype,{FILTER_NONE:0,FILTER_OLDER:1,FILTER_NEWER:2});e.exports=n;},null);
__d("legacy:profile-approval-controller",["ProfileApprovalController"],function(a,b,c,d){a.ProfileApprovalController=b('ProfileApprovalController');},3);
__d("TimelineAllActivitySideNav",["CSS","DOM","DOMDimensions","DOMQuery","FutureSideNav","PageTransitions","Style","UIPagelet","$","copyProperties","csx","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(u){var v=u==='review'||u==='tagreview',w=r('rightColContent'),x=w&&j.scry(w,".fbTimelineLogScrubber")[0];x&&g.conditionShow(x,!v);}var t={init:function(u,v,w,x,y){var z=j.find(o('contentArea'),"._6-0"),aa=h.getID(z);m.set(z,'minHeight',i.getViewportDimensions().height+'px');g.addClass(u,'fixed_elem');s(y||'all');l.registerHandler(function(ba){if(v===ba.getPath()&&ba.getQueryData().sk==w){var ca=p({profile_id:x,renderContentsOnly:1,uripath:ba.toString()},ba.getQueryData()),da=k.getInstance(),ea=da&&da._getItemForKey(ca.log_filter||'all');ea&&da.setLoading(ea);n.loadFromEndpoint('TimelineAllActivityColumn',aa,ca,{jsNonblock:true,constHeight:true,displayCallback:function(fa){fa();ea&&da.setSelected(ea);document.body.scrollTop=0;s(ca.log_filter||'all');l.transitionComplete(true);}});return true;}return false;});}};e.exports=t;},null);
__d("ApprovalQueueCountUpdater",["ge","Arbiter","DOM"],function(a,b,c,d,e,f,g,h,i){var j={updateCounts:function(k,l){var m=k.friends+k.others,n=g('tag_count_friends'),o=g('tag_count_other');h.inform('NavigationMessage/navigationCount',{key:'review',count:m,hide:true});i.setContent(n,k.friends<=l?k.friends:l+"+");i.setContent(o,k.others<=l?k.others:l+"+");}};e.exports=j;},null);