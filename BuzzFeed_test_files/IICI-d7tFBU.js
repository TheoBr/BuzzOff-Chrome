/*!CK:254513875!*//*1414954306,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["NzSjX"]); }

__d("PlaceTagType",[],function(a,b,c,d,e,f){e.exports={CITY:"city",STATE_PROVINCE:"state_province",COUNTRY:"country",PLACE:"place",EVENT:"event",RESIDENCE:"residence",TEXT:"text"};},null);
__d("PlaceUtils",["PlaceTagType"],function(a,b,c,d,e,f,g){var h={placesClose:function(i,j,k,l){i=i||0;j=j||0;k=k||0;l=l||0;return (Math.abs(i-k)<1e-05)&&(Math.abs(j-l)<1e-05);},isNonSpecificPlace:function(i){return (i==g.CITY||i==g.STATE_PROVINCE||i==g.COUNTRY);}};e.exports=h;},null);
__d("PlacesTypeaheadCore",["Arbiter","CSS","Focus","Run","StickyPlaceholderInput","Style","TypeaheadCore","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){for(var o in m)if(m.hasOwnProperty(o))q[o]=m[o];var p=m===null?null:m.prototype;q.prototype=Object.create(p);q.prototype.constructor=q;q.__superConstructor__=m;function q(){"use strict";if(m!==null)m.apply(this,arguments);}q.prototype.init=function(r,s,t){"use strict";p.init.call(this,r,s,t);this.arbiterTokens=[g.subscribe('Places/PlaceCreationCancel'+this.callbackID,function(u,v){this.view.allowPlaceCreation=false;this.view.allowFreeformOption=true;this.view.reset();this.focusElement();}.bind(this))];j.onLeave(function(){this.arbiterTokens.forEach(g.unsubscribe);}.bind(this));this._typeaheadID=t.id;this._citySet=false;this.data.subscribe('fetchComplete',this.update.bind(this));};q.prototype.initToggle=function(){"use strict";var r=this.root.parentNode,s=l.get(r,'position')!='static'?r:this.root,t=this.view,u='PlacesTypeaheadFocused';this.subscribe('focus',function(){t.show();h.addClass(s,u);});this.subscribe('blur',function(){t.hide();h.removeClass(s,u);});};q.prototype.focusElement=function(){"use strict";i.set(this.element);this.value='';this.checkValue();};q.prototype.setValue=function(r){"use strict";p.setValue.call(this,r);k.update(this.element);};q.prototype.updateDataSource=function(r){"use strict";this.data.setQueryData({city_id:this._cityId,city_set:this._citySet});this.data.setBootstrapData({city_id:this._cityId});if(r){this.data.dirty();this.data.bootstrap();}};q.prototype.setCity=function(r,s){"use strict";this._citySet=s;if(this._cityId!==r){this._cityId=r;this.updateDataSource(s);}};q.prototype.update=function(r,s){"use strict";var t=s.response;if(!t)return;var u=t.getPayload();if(u.cityId)if(!this._citySet)this.setCity(u.cityId,false);};n(q.prototype,{resetOnKeyup:false});e.exports=q;},null);
__d("PlacesTypeaheadBehavior",["CSS","DOM"],function(a,b,c,d,e,f,g,h){var i={init:function(j,k){j.subscribe(['reset','select','highlight'],function(l,m){if(l==='highlight'&&m.index!==-1&&m.selected.type!='freeform'&&m.selected.map&&!m.selected.changeCity){h.setContent(k,m.selected.map);g.show(k);}else g.hide(k);});}};e.exports=i;},null);
__d("NoTrucatingCompactTypeaheadRenderer",["CompactTypeaheadRenderer"],function(a,b,c,d,e,f,g){function h(i,j){return g(i,j);}h.className='noTrucating compact';e.exports=h;},null);
__d("PlacesTypeaheadView",["Arbiter","AsyncRequest","CSS","Dialog","DOM","Parent","Run","ScrollableArea","Style","TypeaheadView","copyProperties","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){for(var s in p)if(p.hasOwnProperty(s))u[s]=p[s];var t=p===null?null:p.prototype;u.prototype=Object.create(t);u.prototype.constructor=u;u.__superConstructor__=p;function u(){"use strict";if(p!==null)p.apply(this,arguments);}u.prototype.init=function(){"use strict";this.content=k.find(this.element,'div.PlacesTypeaheadViewList');t.init.call(this);this.subscribe(['render','reset'],this.renderBorders.bind(this));this.arbiterTokens=[g.subscribe('Places/PlaceCreated'+this.callbackID,function(v,w){var x={text:w.name,rawtext:w.name,uid:w.fbid,city_id:w.city_id,city_name:w.city_name,city_page_id:w.city_page_id};this.inform('select',{index:-1,clicked:true,selected:x});this.inform('afterSelect');}.bind(this))];this.arbiterTokens.push(g.subscribe('Events/autoSuggestionSelected',function(v,w){this.inform('select',{index:-1,clicked:true,selected:{text:w.event_name,rawtext:w.event_name,uid:w.event_fbid}});this.inform('afterSelect');}.bind(this)));m.onLeave(function(){this.arbiterTokens.forEach(g.unsubscribe);}.bind(this));};u.prototype.renderBorders=function(){"use strict";i.conditionClass(this.element,'PlacesTypeaheadViewPopulated',this.items.length);};u.prototype.show=function(){"use strict";t.show.call(this);if(!this.results||!this.results.length)o.set(this.element,'height',0);};u.prototype.render=function(v,w,x){"use strict";w.forEach(function(ba){ba.value=v;});if(this.allowFreeformOption&&v&&(!w||w.length===0||w[w.length-1].type!='freeform')){var y=r._("Just use \"{custom_location}\"",{custom_location:v});w.push({uid:'0',rawtext:v,text:y,type:'freeform'});}if(this.allowPlaceCreation&&v&&(!w||w.length===0||w[w.length-1].type!='placecreate')){var z=r._("Add place \"{custom_location}\"",{custom_location:v});w.push({uid:'0',rawtext:v,text:z,type:'placecreate'});}t.render.call(this,v,w,x);this.element.style.visibility='hidden';if(this.visible&&this.results&&this.results.length)o.set(this.element,'height','');var aa=n.getInstance(this.content);aa&&aa.adjustGripper();this.inform('afterRender',w);this.element.style.visibility='';};u.prototype.select=function(v){"use strict";var w=this.index,x=this.results[w];if(x){if(x.type==='placecreate'){j.bootstrap('/ajax/places/create/dialog.php',{name:x.rawtext,callback_id:this.callbackID});return;}if(x.type==='freeform')x.text=x.rawtext;t.select.call(this,v);}};u.prototype.next=function(){"use strict";t.next.call(this);this._scrollIntoView(this.selected);};u.prototype.prev=function(){"use strict";t.prev.call(this);this._scrollIntoView(this.selected);};u.prototype._scrollIntoView=function(v){"use strict";if(!l.byClass(v,'uiScrollableArea'))return;this.ignoreNextMouseover=true;var w=l.byClass(v,'uiScrollableAreaWrap'),x=v.offsetTop-w.offsetTop;if(x<w.scrollTop){w.scrollTop=x;return;}var y=x+v.offsetHeight;if(y>w.scrollTop+w.offsetHeight)w.scrollTop=y-w.offsetHeight;};u.prototype.mouseover=function(event){"use strict";this.ignoreNextMouseover||t.mouseover.call(this,event);this.ignoreNextMouseover=false;};u.prototype.highlight=function(v){"use strict";t.highlight.call(this,v,true);};q(u.prototype,{ignoreNextMouseover:false});e.exports=u;},null);
__d("legacy:PreventSubmitOnEnterTypeaheadBehavior",["TypeaheadPreventSubmitOnEnter"],function(a,b,c,d,e,f,g){if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.preventSubmitOnEnter=function(h){h.enableBehavior(g);};},3);
__d("legacy:ShowResultsOnFocusTypeaheadBehavior",["TypeaheadShowResultsOnFocus"],function(a,b,c,d,e,f,g){if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.showResultsOnFocus=function(h){h.enableBehavior(g);};},3);